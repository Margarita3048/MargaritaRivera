---
title: "Análisis exploratorio de variables morfométricas y productivas de la cepa Lochy _Salmo salar_"
author: Margarita Rivera
date: "`r format(Sys.time(), '%d %B %Y')`"
output: pdf_document
---

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

\tableofcontents

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

# Introducción

El Análisis exploratorio consiste en el uso de gráficos y visualizaciones para poder analizar conjuntos de datos. En este trabajo se realiza un análisis exploratorio de una base de datos de variables morfométricas y productivas de la cepa Lochy de salmón del Atlántico con el fin de visualizar de forma gráfica y tabular algunas variables que puedan estar relacionadas con la edad de maduración en la cepa. 

# DESARROLLO

**1. Instalación de librerías**

Las librerías empleadas en el desarrrollo de este reporte fueron:

|:**Librería**:|:**Función**:|
|--------------|-------------|
|readxl|Lectura de archivos con extensión xlsx|
|dplyr|permite la manipulación y distintas operaciones con data frames (trabajo con tuberías)|
|ggplot2|Visualización de datos a través de generación de gráficos|
|pander|Generación y estética de tablas|

```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = F)
library(readxl)
library(dplyr)
library(ggplot2)
library(pander)

dat<-read_excel("salmon_dat.xlsx")
```

**2. HISTOGRAMAS PARA VARIABLES CUANTITATIVAS**

**Describir la variación de las variables de estudio usando histogramas**

**2.1. Histograma para peso corporal (g)**

```{r}

dat%>%ggplot(aes(x=`PESO_(g)`))+ geom_histogram(position = 'identity', col='black', fill='blue', alpha=0.4)+labs(title="Histograma de peso corporal (g)")+ theme (axis.text.x = element_text(face="bold", colour="black"), axis.text.y = element_text(face="bold", colour="black", angle=90, hjust=0.5))+theme(panel.background = element_rect(fill = "transparent"))+labs(x= "Peso (g)")+theme_classic()

```


**1.2. Histograma de longitud (cm)**

```{r}
dat%>%ggplot(aes(x=`LONGITUD_(cm)`))+ geom_histogram(col='black', fill='blue', alpha=0.5)+labs(title="Histograma de longitud (cm)")+ theme (axis.text.x = element_text(face="bold", colour="black"), axis.text.y = element_text(face="bold", colour="black", angle=90, hjust=0.5))+theme(panel.background = element_rect(fill = "transparent"))+labs(x= "Longitud (cm)")+theme_classic()
```


**1.3. Histograma de peso gonadal (g)**

```{r}
dat%>%ggplot(aes(x=`PESO_GONADA_(g)`))+ geom_histogram( col='black', fill='blue', alpha=0.5)+labs(title="Histograma de peso gonadal (g)")+ theme (axis.text.x = element_text(face="bold", colour="black"), axis.text.y = element_text(face="bold", colour="black", angle=90, hjust=0.5))+theme(panel.background = element_rect(fill = "transparent"))+labs(x= "Peso gonadal (cm)")+theme_classic()
```

**1.4. Histograma de índice gonadosomático (g)**

```{r}
data<-dat%>%mutate(IGS = ((`PESO_GONADA_(g)`/`PESO_(g)`)*100))
data%>%ggplot(aes(x=IGS))+ geom_histogram( col='black', fill='blue', alpha=0.5)+labs(title="Histograma de índice gonadosomático")+ theme (axis.text.x = element_text(face="bold", colour="black"), axis.text.y = element_text(face="bold", colour="black", angle=90, hjust=0.5))+theme(panel.background = element_rect(fill = "transparent"))+labs(x= "Índice gonadosomático")+theme_classic()
```

### 2. TABLAS DE FRECUENCIAS

- Identifica si los datos están balanceados o no entre tratamientos usando tablas de frecuencia (4 puntos).
**2.1. Peso corporal (g) por sexo, estadío de madurez y familia**

```{r}
table1<-table(data$SEXO, data$ESTADIO, data$FAMILIA)
pander::pander(table1, caption="Tabla de frecuencias para peso corporal por sexo, cepa y familia")
```

### 3. RELACIÓN ENTRE VARIABLES

Establece relación entre variables cuantitativas y factores usando gráficas de correlación, boxplot, interacción o de tamaño de los efectos (4 puntos).

**3.1. CORRELACIÓN**

**3.1.1. Correlación entre peso y longitud**

H0: La correlación poblacional entre peso y longitud es igual a 0
H1: La correlación poblacional entre peso y longitud es distinta de 0

```{r}
data%>%ggplot(aes(x=data$`PESO_(g)`, y= data$`LONGITUD_(cm)`))+ geom_point()+labs(title="Histograma de índice gonadosomático")+ theme (axis.text.x = element_text(face="bold", colour="black"), axis.text.y = element_text(face="bold", colour="black", angle=90, hjust=0.5))+theme(panel.background = element_rect(fill = "transparent"))+labs(x= "Peso corporal (g)", y="Longitud (cm)")+ geom_smooth(method = "lm", se = FALSE)+theme_classic()

cor_L_P<- cor.test(x=data$`PESO_(g)`, y= data$`LONGITUD_(cm)`  , method = "pearson", conf.level = 0.95)
cor_L_P
IC_cor_L_P <-cor_L_P$conf.int
IC_cor_L_P
pander::pander(cor_L_P, caption = "Prueba de hipótesis para el coeficiente de correlación entre Longitud y Peso.")

```

**3.1.2. Correlación entre peso corporal y peso gonadal**

```{r}

```

**3.1.3. Correlación entre peso corporal e IGS**

```{r}

```

**3.1.4. Correlación entre longitud y peso gonadal**

```{r}

```

**3.1.5. Correlación entre longitud e IGS**

```{r}

```

**3.1.6. Correlación entre  peso gonadal e IGS**

```{r}

```

**3.2. BOXPLOT**

**3.2.1. Peso por estadío y familia**

```{r}
data%>%ggplot(aes(x=data$ESTADIO, y= `PESO_(g)`))+ geom_boxplot()+labs(title="Peso por estadio y familia")+ theme (axis.text.x = element_text(face="bold", colour="black"), axis.text.y = element_text(face="bold", colour="black", angle=90, hjust=0.5))+theme(panel.background = element_rect(fill = "transparent"))+labs(x= "Estadío", y="Peso corporal (g)")+theme_classic()
```

**3.2.2. Longitud por estadío y familia**

```{r}

```

**3.2.3. Peso gonadal por estadío y familia**

```{r}

```

**3.2.4. índice gonadosomático por estadío y familia**

```{r}

```

**3.3. TAMAÑO DE LOS EFECTOS**

```{r}
lot.design(maturation_age ~ data$Sex+ data$vgll3_Genotype+data$YC, xlab = "Factores", ylab = "Maduracion", main="Maduracion: Importancia factores")
```


### 4. ERRORES Y DATOS ATÍPICOS

Identifica si existen errores, datos faltantes o valores atípicos (4 puntos).

### 5. ESTADÍSTICA DESCRIPTIVA

Resume los datos usando tablas y estadística descriptiva (4 puntos).

```{r}

```


# Referencias 
